

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Using supervisord &mdash; PokemonGo-Map 2.1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="PokemonGo-Map 2.1.0 documentation" href="../index.html"/>
        <link rel="up" title="Extras" href="index.html"/>
        <link rel="next" title="Workers" href="workers.html"/>
        <link rel="prev" title="Nginx" href="nginx.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> PokemonGo-Map
          

          
          </a>

          
            
            
              <div class="version">
                2.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic-install/index.html">Basic Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced-install/index.html">Advanced Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Extras</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="beehive.html">Behive</a></li>
<li class="toctree-l2"><a class="reference internal" href="environment-variables-fix.html">Windows ENV Fix</a></li>
<li class="toctree-l2"><a class="reference internal" href="external.html">External Access to Map</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html">Common Questions and Answers</a></li>
<li class="toctree-l2"><a class="reference internal" href="mysql.html">Using a MySQL Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="nginx.html">Nginx</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Using supervisord</a></li>
<li class="toctree-l2"><a class="reference internal" href="workers.html">Workers</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">PokemonGo-Map</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 







<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
        <li><a href="index.html">Extras</a> &raquo;</li>
      
    <li>Using supervisord</li>
    <li class="wy-breadcrumbs-aside">
      
          
          <a href="../_sources/extras/supervisord-config-files.txt" rel="nofollow"> View page source</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="using-supervisord">
<span id="using-supervisord"></span><h1>Using supervisord<a class="headerlink" href="#using-supervisord" title="Permalink to this headline">¶</a></h1>
<div class="section" id="assuming">
<span id="assuming"></span><h2>Assuming:<a class="headerlink" href="#assuming" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>You are running on Linux</li>
<li>You have installed <a class="reference external" href="http://supervisord.org/">supervisord</a></li>
<li>You have seen a shell prompt at least a few times in your life</li>
<li>You have configured your stuff properly in <code class="docutils literal"><span class="pre">config.ini</span></code></li>
<li>You understand worker separation</li>
<li>You can tie your own shoelaces</li>
</ul>
</div>
<div class="section" id="the-good-stuff">
<span id="the-good-stuff"></span><h2>The good stuff<a class="headerlink" href="#the-good-stuff" title="Permalink to this headline">¶</a></h2>
<p>Create directory <code class="docutils literal"><span class="pre">~/supervisor</span></code>, and <code class="docutils literal"><span class="pre">~/supervisor/procs.d</span></code></p>
<p>Create file <code class="docutils literal"><span class="pre">~/supervisor/supervisord.conf</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>; Sample supervisor config file.
;
; For more information on the config file, please see:
; http://supervisord.org/configuration.html
;
; Notes:
;  - Shell expansion (&quot;~&quot; or &quot;$HOME&quot;) is not supported.  Environment
;    variables can be expanded using this syntax: &quot;%(ENV_HOME)s&quot;.
;  - Comments must have a leading space: &quot;a=b ;comment&quot; not &quot;a=b;comment&quot;.

[unix_http_server]
file=/tmp/supervisor.sock   ; (the path to the socket file)
;chmod=0700                 ; socket file mode (default 0700)
;chown=nobody:nogroup       ; socket file uid:gid owner
;username=user              ; (default is no username (open server))
;password=123               ; (default is no password (open server))

;[inet_http_server]         ; inet (TCP) server disabled by default
;port=127.0.0.1:9001        ; (ip_address:port specifier, *:port for all iface)
;username=user              ; (default is no username (open server))
;password=123               ; (default is no password (open server))

[supervisord]
logfile=/tmp/supervisord.log ; (main log file;default $CWD/supervisord.log)
logfile_maxbytes=50MB        ; (max main logfile bytes b4 rotation;default 50MB)
logfile_backups=10           ; (num of main logfile rotation backups;default 10)
loglevel=info                ; (log level;default info; others: debug,warn,trace)
pidfile=/tmp/supervisord.pid ; (supervisord pidfile;default supervisord.pid)
nodaemon=false               ; (start in foreground if true;default false)
minfds=1024                  ; (min. avail startup file descriptors;default 1024)
minprocs=200                 ; (min. avail process descriptors;default 200)
;umask=022                   ; (process file creation umask;default 022)
user=root                    ; (default is current user, required if root)
;identifier=supervisor       ; (supervisord identifier, default is &#39;supervisor&#39;)
directory=/opt/pogo/         ; (default is not to cd during start)
;nocleanup=true              ; (don&#39;t clean up tempfiles at start;default false)
;childlogdir=/tmp            ; (&#39;AUTO&#39; child log dir, default $TEMP)
;environment=KEY=&quot;value&quot;     ; (key value pairs to add to environment)
;strip_ansi=false            ; (strip ansi escape codes in logs; def. false)

; the below section must remain in the config file for RPC
; (supervisorctl/web interface) to work, additional interfaces may be
; added by defining them in separate rpcinterface: sections
[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

[supervisorctl]
serverurl=unix:///tmp/supervisor.sock ; use a unix:// URL  for a unix socket
;serverurl=http://127.0.0.1:9001 ; use an http:// url to specify an inet socket
;username=user               ; should be same as http_username if set
;password=123                ; should be same as http_password if set
;prompt=mysupervisor         ; cmd line prompt (default &quot;supervisor&quot;)
;history_file=~/.sc_history  ; use readline history if available

; The below sample program section shows all possible program subsection values,
; create one or more &#39;real&#39; program: sections to be able to control them under
; supervisor.

;[program:theprogramname]
;command=/bin/cat              ; the program (relative uses PATH, can take args)
;process_name=%(program_name)s ; process_name expr (default %(program_name)s)
;numprocs=1                    ; number of processes copies to start (def 1)
;directory=/tmp                ; directory to cwd to before exec (def no cwd)
;umask=022                     ; umask for process (default None)
;priority=999                  ; the relative start priority (default 999)
;autostart=true                ; start at supervisord start (default: true)
;startsecs=1                   ; # of secs prog must stay up to be running (def. 1)
;startretries=3                ; max # of serial start failures when starting (default 3)
;autorestart=unexpected        ; when to restart if exited after running (def: unexpected)
;exitcodes=0,2                 ; &#39;expected&#39; exit codes used with autorestart (default 0,2)
;stopsignal=QUIT               ; signal used to kill process (default TERM)
;stopwaitsecs=10               ; max num secs to wait b4 SIGKILL (default 10)
;stopasgroup=false             ; send stop signal to the UNIX process group (default false)
;killasgroup=false             ; SIGKILL the UNIX process group (def false)
;user=chrism                   ; setuid to this UNIX account to run the program
;redirect_stderr=true          ; redirect proc stderr to stdout (default false)
;stdout_logfile=/a/path        ; stdout log path, NONE for none; default AUTO
;stdout_logfile_maxbytes=1MB   ; max # logfile bytes b4 rotation (default 50MB)
;stdout_logfile_backups=10     ; # of stdout logfile backups (default 10)
;stdout_capture_maxbytes=1MB   ; number of bytes in &#39;capturemode&#39; (default 0)
;stdout_events_enabled=false   ; emit events on stdout writes (default false)
;stderr_logfile=/a/path        ; stderr log path, NONE for none; default AUTO
;stderr_logfile_maxbytes=1MB   ; max # logfile bytes b4 rotation (default 50MB)
;stderr_logfile_backups=10     ; # of stderr logfile backups (default 10)
;stderr_capture_maxbytes=1MB   ; number of bytes in &#39;capturemode&#39; (default 0)
;stderr_events_enabled=false   ; emit events on stderr writes (default false)
;environment=A=&quot;1&quot;,B=&quot;2&quot;       ; process environment additions (def no adds)
;serverurl=AUTO                ; override serverurl computation (childutils)

; The below sample eventlistener section shows all possible
; eventlistener subsection values, create one or more &#39;real&#39;
; eventlistener: sections to be able to handle event notifications
; sent by supervisor.

;[eventlistener:theeventlistenername]
;command=/bin/eventlistener    ; the program (relative uses PATH, can take args)
;process_name=%(program_name)s ; process_name expr (default %(program_name)s)
;numprocs=1                    ; number of processes copies to start (def 1)
;events=EVENT                  ; event notif. types to subscribe to (req&#39;d)
;buffer_size=10                ; event buffer queue size (default 10)
;directory=/tmp                ; directory to cwd to before exec (def no cwd)
;umask=022                     ; umask for process (default None)
;priority=-1                   ; the relative start priority (default -1)
;autostart=true                ; start at supervisord start (default: true)
;startsecs=1                   ; # of secs prog must stay up to be running (def. 1)
;startretries=3                ; max # of serial start failures when starting (default 3)
;autorestart=unexpected        ; autorestart if exited after running (def: unexpected)
;exitcodes=0,2                 ; &#39;expected&#39; exit codes used with autorestart (default 0,2)
;stopsignal=QUIT               ; signal used to kill process (default TERM)
;stopwaitsecs=10               ; max num secs to wait b4 SIGKILL (default 10)
;stopasgroup=false             ; send stop signal to the UNIX process group (default false)
;killasgroup=false             ; SIGKILL the UNIX process group (def false)
;user=chrism                   ; setuid to this UNIX account to run the program
;redirect_stderr=false         ; redirect_stderr=true is not allowed for eventlisteners
;stdout_logfile=/a/path        ; stdout log path, NONE for none; default AUTO
;stdout_logfile_maxbytes=1MB   ; max # logfile bytes b4 rotation (default 50MB)
;stdout_logfile_backups=10     ; # of stdout logfile backups (default 10)
;stdout_events_enabled=false   ; emit events on stdout writes (default false)
;stderr_logfile=/a/path        ; stderr log path, NONE for none; default AUTO
;stderr_logfile_maxbytes=1MB   ; max # logfile bytes b4 rotation (default 50MB)
;stderr_logfile_backups=10     ; # of stderr logfile backups (default 10)
;stderr_events_enabled=false   ; emit events on stderr writes (default false)
;environment=A=&quot;1&quot;,B=&quot;2&quot;       ; process environment additions
;serverurl=AUTO                ; override serverurl computation (childutils)

; The below sample group section shows all possible group values,
; create one or more &#39;real&#39; group: sections to create &quot;heterogeneous&quot;
; process groups.

;[group:thegroupname]
;programs=progname1,progname2  ; each refers to &#39;x&#39; in [program:x] definitions
;priority=999                  ; the relative start priority (default 999)

; The [include] section can just contain the &quot;files&quot; setting.  This
; setting can list multiple files (separated by whitespace or
; newlines).  It can also contain wildcards.  The filenames are
; interpreted as relative to this file.  Included files *cannot*
; include files themselves.

[program:webserver]
command=/usr/bin/python ./runserver.py -os -C -t 20 -l &quot;INITIAL LOCATION&quot; -fl
process_name=webserver
numprocs=1
directory=/opt/pogo/
startsec=15
startretries=3
autorestart=true
stopwaitsecs=5
stdout_logfile=/tmp/supervisor_webserver.log
stderr_logfile=/tmp/supervisor_webserver.log

[include]
files = procs.d/*.ini
</pre></div>
</div>
<p>In this file, change <code class="docutils literal"><span class="pre">user=</span></code>, <code class="docutils literal"><span class="pre">directory=</span></code> and <code class="docutils literal"><span class="pre">command=</span></code> to reflect your username, directory where your <code class="docutils literal"><span class="pre">runserver.py</span></code> is stored, and change the LOCATION of your webserver thread.</p>
<p>Create file <code class="docutils literal"><span class="pre">~/supervisor/sample.ini</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">program</span><span class="p">:</span><span class="n">workerWRK</span><span class="p">]</span>
<span class="n">command</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">python</span> <span class="o">./</span><span class="n">runserver</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">ns</span> <span class="o">-</span><span class="n">l</span> <span class="s2">&quot;LOC&quot;</span>
<span class="n">process_name</span><span class="o">=</span><span class="n">worker_WRK</span>
<span class="n">numprocs</span><span class="o">=</span><span class="mi">1</span>
<span class="n">directory</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">pogo</span><span class="o">/</span>
<span class="n">startsec</span><span class="o">=</span><span class="mi">15</span>
<span class="n">startretries</span><span class="o">=</span><span class="mi">3</span>
<span class="n">autorestart</span><span class="o">=</span><span class="n">true</span>
<span class="n">stopwaitsecs</span><span class="o">=</span><span class="mi">5</span>
<span class="n">stdout_logfile</span><span class="o">=/</span><span class="n">tmp</span><span class="o">/</span><span class="n">supervisor_workerWRK</span><span class="o">.</span><span class="n">log</span>
<span class="n">stderr_logfile</span><span class="o">=/</span><span class="n">tmp</span><span class="o">/</span><span class="n">supervisor_workerWRK</span><span class="o">.</span><span class="n">log</span>
</pre></div>
</div>
<p>In this file, change the <code class="docutils literal"><span class="pre">directory=</span></code> line to point to the directory where your script is stored.</p>
<p>Create file <code class="docutils literal"><span class="pre">~/supervisor/gen-workers.sh</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>#!/bin/bash
#cleaning up directory
rm -f procs.d/*.ini
WORKER=0
while read LINE; do
  WORKER=$((WORKER+1))
  cp sample.ini procs.d/worker_$WORKER.ini
  sed -i&#39;&#39; &quot;s/WRK/$WORKER/&quot; procs.d/worker_$WORKER.ini
  sed -i&#39;&#39; &quot;s/LOC/$LINE/&quot; procs.d/worker_$WORKER.ini
done &lt; coords.txt
</pre></div>
</div>
<p>Create file <code class="docutils literal"><span class="pre">~/supervisor/coords.txt</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mf">44.4908702</span><span class="p">,</span> <span class="mf">26.0084664</span>
<span class="mf">44.4652468</span><span class="p">,</span> <span class="mf">26.0084664</span>
<span class="mf">44.4396234</span><span class="p">,</span> <span class="mf">26.0084664</span>
<span class="mf">44.4140000</span><span class="p">,</span> <span class="mf">26.0084664</span>
<span class="mf">44.3883766</span><span class="p">,</span> <span class="mf">26.0084664</span>
<span class="mf">44.5036861</span><span class="p">,</span> <span class="mf">26.0395188</span>
<span class="mf">44.4780627</span><span class="p">,</span> <span class="mf">26.0395188</span>
<span class="mf">44.4524393</span><span class="p">,</span> <span class="mf">26.0395188</span>
<span class="mf">44.4268159</span><span class="p">,</span> <span class="mf">26.0395188</span>
<span class="mf">44.4011925</span><span class="p">,</span> <span class="mf">26.0395188</span>
<span class="mf">44.5165104</span><span class="p">,</span> <span class="mf">26.0705790</span>
<span class="mf">44.4908870</span><span class="p">,</span> <span class="mf">26.0705790</span>
<span class="mf">44.4652636</span><span class="p">,</span> <span class="mf">26.0705790</span>
<span class="mf">44.4396402</span><span class="p">,</span> <span class="mf">26.0705790</span>
<span class="mf">44.4140168</span><span class="p">,</span> <span class="mf">26.0705790</span>
<span class="mf">44.3883934</span><span class="p">,</span> <span class="mf">26.0705790</span>
<span class="mf">44.3627700</span><span class="p">,</span> <span class="mf">26.0705790</span>
<span class="mf">44.5293263</span><span class="p">,</span> <span class="mf">26.1016451</span>
<span class="mf">44.5037029</span><span class="p">,</span> <span class="mf">26.1016451</span>
<span class="mf">44.4780795</span><span class="p">,</span> <span class="mf">26.1016451</span>
<span class="mf">44.4524561</span><span class="p">,</span> <span class="mf">26.1016451</span>
<span class="mf">44.4268327</span><span class="p">,</span> <span class="mf">26.1016451</span>
<span class="mf">44.4012093</span><span class="p">,</span> <span class="mf">26.1016451</span>
<span class="mf">44.3755859</span><span class="p">,</span> <span class="mf">26.1016451</span>
<span class="mf">44.5165104</span><span class="p">,</span> <span class="mf">26.1327183</span>
<span class="mf">44.4908870</span><span class="p">,</span> <span class="mf">26.1327183</span>
<span class="mf">44.4652636</span><span class="p">,</span> <span class="mf">26.1327183</span>
<span class="mf">44.4396402</span><span class="p">,</span> <span class="mf">26.1327183</span>
<span class="mf">44.4140168</span><span class="p">,</span> <span class="mf">26.1327183</span>
<span class="mf">44.3883934</span><span class="p">,</span> <span class="mf">26.1327183</span>
<span class="mf">44.3627700</span><span class="p">,</span> <span class="mf">26.1327183</span>
<span class="mf">44.5036861</span><span class="p">,</span> <span class="mf">26.1637714</span>
<span class="mf">44.4780627</span><span class="p">,</span> <span class="mf">26.1637714</span>
<span class="mf">44.4524393</span><span class="p">,</span> <span class="mf">26.1637714</span>
<span class="mf">44.4268159</span><span class="p">,</span> <span class="mf">26.1637714</span>
<span class="mf">44.4011925</span><span class="p">,</span> <span class="mf">26.1637714</span>
<span class="mf">44.3755691</span><span class="p">,</span> <span class="mf">26.1637714</span>
<span class="mf">44.4908702</span><span class="p">,</span> <span class="mf">26.1948309</span>
<span class="mf">44.4652468</span><span class="p">,</span> <span class="mf">26.1948309</span>
<span class="mf">44.4396234</span><span class="p">,</span> <span class="mf">26.1948309</span>
<span class="mf">44.4140000</span><span class="p">,</span> <span class="mf">26.1948309</span>
</pre></div>
</div>
<p><strong><em>Don&#8217;t be dumb, use your ACTUAL coordinates, ONE PER LINE, NO EMPTY LINES!</em></strong></p>
<p>Then run the gen-workers.sh script</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">~/</span><span class="n">supervisor</span><span class="o">/</span>
<span class="n">bash</span> <span class="o">./</span><span class="n">gen</span><span class="o">-</span><span class="n">workers</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>You should now have a bunch of .ini files in <code class="docutils literal"><span class="pre">~/supervisor/procs.d/</span></code></p>
<p>You can now do:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">~/</span><span class="n">supervisor</span>
<span class="n">supervisord</span> <span class="o">-</span><span class="n">c</span> <span class="n">supervisor</span>
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="workers.html" class="btn btn-neutral float-right" title="Workers" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="nginx.html" class="btn btn-neutral" title="Nginx" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Pokemon Masters.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'2.1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>